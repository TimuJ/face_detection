# Текущий статус

Сделал готовые и работающие сетки по распознаванию лица с приличным результатом

# TODO

- расширить количество возможных сеток
- понять, как распознавать несколько лиц на одном изображении

# Файл содержит описание к следующим скриптам в директории

# train.py

Скрипт с логикой тренировки сетки, сохраняет веса и модель в назначенную директорию

# train_config.json

Конфиг файл для скрипта train.py

# test.py

Скрипт test.py, выдаёт предсказания в виде файлов .pts　с названием соответствующим изображениям из указанной папки, сохраняет в указанную папку

# test_config.json

Конфиг файл для скрипта test.py

# requirements.txt

файл с pip freeze, содержащий все используемые библиотеки

## папка src

### src/model.py

Папка с моделями, пока есть только резнет34, можно расширить

### src/dataset.py

Папка с логикой создания датасэта, на случай если надо будет реализовать свою логику датасэта

## папка utils

### utils/count_ced_for_points.py

Была добавлена нормализация по прямоугольнику лица, определяемому библиотекой dlib, изображения для лиц считываеются с папки gt_path

### utils/face_point_detection_dlib.py

Скрипт предсказывает 68 ключевых точек для изображений лица, принимает следующие аргументы:

- __predictions_path__ путь до папки с картинками, лица которых надо предсказать
- __output_path__ путь до папки, где будут храниться .pts файлы с предсказанными точками, каждому изображению соответствует соотвутствующий .pts файл в данной директории
- __predictor_path__ путь до .dat файла с весами dlib модели
- __dlib_pred_path__ путь до папки с предсказаниями dlib на случай, если нужно на одном графике отобразить несолько AUC кривых

### utils/train_val_split.py

Скрипт разделяет папку train на train и val, работает для keypoints, то есть перемещает .pts, .jpg/.png Аргументы следующеие:

- __train_path__ путь до папки, содержащей папку train, то есть если train лежит в data/ds/train, то нужно вводить data/ds

- __split_ratio__ доля валидационного сэта, например 0.1

## Working notebooks

Рабочие ноутбуки .ipynb

### face_alignment_utils.ipynb

Ноутбук с предобработкой данных

### face_alignment_dlib_main.ipynb

Рабочий ноутбук, в котором хранятся эксперименты с библиотекой dlib

### face_alignment_resnetv2.ipynb

Рабочий ноутбук с готовыми скриптами по тренировке и предсказаниями на базе резнета

### face_alignment_resnet.ipynb

Попытался сделать через резнет50 для ключевых точек, но там только одна модель, которая весит 226 мб, так что до конца не довел

### face_alignment_onet.ipynb

Накидал о-нет на торче, но подумал, что реснет может быть поэффективнее, в дальнейшем можно перенестив конечную библиоеку и о-нет

### face_alignment_gh.ipynb

хотел использовать библиотечку face-alignment с github, но подумал, что от меня ждут всё-таки реализованную модельку со статьи, ну или хотя бы что-то на торче написанное, а то так будет нечестно
