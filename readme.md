# Текущий статус

Разобрался с dlib, переделал метрику под нормализацию на прямоугольник лица от dlib, сетку написал в ноутбуке face_alignment_resnet.ipynb, но результаты и их обработка займут время. А рефакторинг кода и оформление в виде скриптов ещё больше.

Первоочередная задача закрыть отчёт и получить метрики по реснету

# Файл содержит описание к следующим скриптам в директории

## utils/count_ced_for_points.py

Была добавлена нормализация по прямоугольнику лица, определяемому библиотекой dlib, изображения для лиц считываеются с папки gt_path

## utils/face_point_detection_dlib.py

Скрипт предсказывает 68 ключевых точек для изображений лица, принимает следующие аргументы:

- __predictions_path__ путь до папки с картинками, лица которых надо предсказать
- __output_path__ путь до папки, где будут храниться .pts файлы с предсказанными точками, каждому изображению соответствует соотвутствующий .pts файл в данной директории
- __predictor_path__ путь до .dat файла с весами dlib модели
- __dlib_pred_path__ путь до папки с предсказаниями dlib на случай, если нужно на одном графике отобразить несолько AUC кривых

## utils/train_val_split.py

Скрипт разделяет папку train на train и val, работает для keypoints, то есть перемещает .pts, .jpg/.png Аргументы следующеие:

- __train_path__ путь до папки, содержащей папку train, то есть если train лежит в data/ds/train, то нужно вводить data/ds

- __split_ratio__ доля валидационного сэта, например 0.1

## face_alignment_utils.ipynb

Ноутбук с предобработкой данных

## face_alignment_dlib_main.ipynb

Рабочий ноутбук, в котором хранятся эксперименты с библиотекой dlib

## face_alignment_resnet.ipynb

### в работе

Рабочий ноутбук с попыткой реализовать point detector на спине resnet_50

На данный момент сетка написана, но одна эпоха занимает около 2.5 часов и к дедлайну я получить

## face_alignment_onet.ipynb

чисто накидал о-нет на торче, но подумал, что реснет может быть поэффективнее, хотя потяжелее

## face_alignment_gh.ipynb

хотел использовать библиотечку face-alignment с github, но подумал, что от меня ждут всё-таки реализованную модельку со статьи, ну или хотя бы что-то на торче написанное, а то так будет нечестно
